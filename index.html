<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Diagnostics</title>
  <style>body{font-family:system-ui,Arial;margin:24px}button{padding:10px 14px;border-radius:10px;border:1px solid #ccc}pre{background:#111;color:#eee;padding:12px;border-radius:10px;white-space:pre-wrap}</style>
</head>
<body>
  <h1>Diagnostics</h1>
  <button id="run">Run diagnostics</button>
  <pre id="out"></pre>
  <script>
    const btn=document.getElementById('run'), out=document.getElementById('out');
    function log(k,v){ out.textContent += `${k}: ${v}\n`; }
    btn.addEventListener('click', async () => {
      out.textContent='';
      log('URL', location.href);
      log('Protocol', location.protocol);
      log('isSecureContext', window.isSecureContext);
      try{
        if(navigator.permissions?.query){
          const p = await navigator.permissions.query({name:'camera'});
          log('permissions(camera)', p.state);
        } else { log('permissions', 'not supported'); }
      }catch(e){ log('permissions error', e?.message||e); }
      try{
        if(navigator.mediaDevices?.enumerateDevices){
          const devs = await navigator.mediaDevices.enumerateDevices();
          const counts = devs.reduce((m,d)=> (m[d.kind]=(m[d.kind]||0)+1, m), {});
          log('devices', JSON.stringify(counts));
        } else { log('enumerateDevices','not supported'); }
      }catch(e){ log('enumerateDevices error', e?.message||e); }
    });
  </script>
</body>
</html>
